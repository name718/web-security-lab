<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Debug æ¥å£æš´éœ² - æ•æ„Ÿä¿¡æ¯æ³„éœ²</title>
  <link rel="stylesheet" href="../xss/style.css">
  <style>
    .leak-data { background: #1a1a2e; color: #0f0; padding: 15px; border-radius: 8px; font-family: monospace; font-size: 12px; max-height: 400px; overflow: auto; white-space: pre-wrap; }
    .danger-badge { background: #f44336; color: white; padding: 2px 8px; border-radius: 4px; font-size: 12px; }
  </style>
</head>
<body>
  <div class="container">
    <a href="index.html" class="back-link">â† è¿”å›æ•æ„Ÿä¿¡æ¯æ³„éœ²</a>
    <h1>ğŸ› å®éªŒä¸€ï¼šDebug æ¥å£æš´éœ²</h1>

    <div class="warning-box">
      <strong>âš ï¸ æ¼æ´åœºæ™¯</strong>
      <p>å¼€å‘ç¯å¢ƒçš„è°ƒè¯•æ¥å£åœ¨ç”Ÿäº§ç¯å¢ƒæœªå…³é—­ï¼Œæ”»å‡»è€…å¯ç›´æ¥è®¿é—®è·å–æ•æ„Ÿé…ç½®</p>
    </div>

    <section>
      <h2>ğŸ® æ”»å‡»æ¼”ç¤º</h2>
      <div class="info-box">
        <p>å¸¸è§çš„ Debug æ¥å£è·¯å¾„ï¼š</p>
        <ul>
          <li><code>/debug</code> - è‡ªå®šä¹‰è°ƒè¯•æ¥å£</li>
          <li><code>/actuator</code> - Spring Boot Actuator</li>
          <li><code>/__debug__</code> - æ¡†æ¶è°ƒè¯•ç«¯ç‚¹</li>
          <li><code>/phpinfo.php</code> - PHP ä¿¡æ¯é¡µ</li>
        </ul>
        <button onclick="fetchDebug()" class="btn" style="margin-top: 10px;">è®¿é—® /api/infoleak/unsafe/debug</button>
      </div>
      
      <h3>æ³„éœ²çš„æ•°æ® <span class="danger-badge">å±é™©</span></h3>
      <div class="leak-data" id="debug-result">ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æŸ¥çœ‹æ³„éœ²å†…å®¹...</div>
    </section>

    <section>
      <h2>ğŸ’€ æ³„éœ²å†…å®¹åˆ†æ</h2>
      <table class="info-table">
        <tr><th>æ³„éœ²é¡¹</th><th>å±å®³</th></tr>
        <tr><td>æ•°æ®åº“è¿æ¥ä¿¡æ¯</td><td>æ”»å‡»è€…å¯ç›´æ¥è¿æ¥æ•°æ®åº“</td></tr>
        <tr><td>AWS å¯†é’¥</td><td>äº‘èµ„æºè¢«å®Œå…¨æ§åˆ¶</td></tr>
        <tr><td>JWT Secret</td><td>å¯ä¼ªé€ ä»»æ„ç”¨æˆ· Token</td></tr>
        <tr><td>API Keys</td><td>ç¬¬ä¸‰æ–¹æœåŠ¡è¢«æ»¥ç”¨</td></tr>
      </table>
    </section>

    <section>
      <h2>ğŸ›¡ï¸ é˜²å¾¡æ–¹æ¡ˆ</h2>
      <pre><code>// 1. ç¯å¢ƒåˆ¤æ–­
if (process.env.NODE_ENV === 'production') {
  // ç¦ç”¨æ‰€æœ‰è°ƒè¯•è·¯ç”±
}

// 2. IP ç™½åå•
app.use('/debug', (req, res, next) => {
  const allowedIPs = ['127.0.0.1', '10.0.0.0/8']
  if (!isAllowed(req.ip, allowedIPs)) {
    return res.status(403).send('Forbidden')
  }
  next()
})

// 3. è®¤è¯ä¿æŠ¤
app.use('/debug', requireAdminAuth)</code></pre>
    </section>
  </div>

  <script>
    async function fetchDebug() {
      const res = await fetch('/api/infoleak/unsafe/debug')
      const data = await res.json()
      document.getElementById('debug-result').textContent = JSON.stringify(data, null, 2)
    }
  </script>
</body>
</html>
